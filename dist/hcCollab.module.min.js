var e={d:(a,t)=>{for(var i in t)e.o(t,i)&&!e.o(a,i)&&Object.defineProperty(a,i,{enumerable:!0,get:t[i]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)},a={};e.d(a,{$:()=>y,$T:()=>N,$j:()=>ie,CS:()=>S,O5:()=>F,Vt:()=>V,XG:()=>x,dj:()=>O,f4:()=>J,hy:()=>j,j2:()=>te,pw:()=>P,vy:()=>h,zP:()=>M});var t,i,o,n=null,s=!1,l=!1,r=!1,c=!1,d=!1,u=!1,m=!1,b=!1,f=!1,C=!1,p=!1,w=!1,v="",g=null,k=null;function y(){return!!n}function M(){n&&(n.disconnect(),n=null),p=!1,w=!1}function S(){if(n)return{id:n.id,name:t}}function h(){return p}function P(){return w}function N(){!n||p||w||n.emit("lockSession",""),p=!0}function J(){n&&p&&n.emit("unlockSession",""),p=!1}function V(e){n.emit("chatmessage",JSON.stringify({user:t,message:e}))}function x(e){C=e}function j(e){return C}function O(e){n&&(e.type="custommessage",e.user=t,n.emit("hcmessage",JSON.stringify(e)))}function z(e,a){n&&(a.type=e,a.user=t,n.emit("hcmessage",JSON.stringify(a)))}function F(e){k=e}function E(e){s||!n||C||w?s=!1:z("camera",{camera:e.toJson()})}function D(e){if(!n||C||l||w)l=!1;else{let e=[],a=hwv.selectionManager.getResults();for(let t=0;t<a.length;t++)e.push(a[t].toJson());z("selection",{selection:e})}}async function I(e,a,t){return!n||C||r||w?r=!1:z("visibility",{nodeids:e,onoff:a}),await i.model.setNodesVisibilityCollab(e,a,t)}async function W(){return!n||C||r||w?r=!1:z("resetvisibilities",{}),await i.model.resetNodesVisibilityCollab()}async function B(e){return!n||C||w||z("setdrawmode",{drawmode:e}),await i.view.setDrawModeCollab(e)}async function L(e){return!n||C||w||z("setprojectionmode",{projectionmode:e}),await i.view.setProjectionModeCollab(e)}async function _(){return!n||C||w||z("reset",{}),await i.model.resetCollab()}async function A(){return!n||C||w||z("clear",{}),await i.model.clearCollab()}async function H(e,a){return!n||C||c||w?c=!1:(a.toJson(),z("matrix",{nodeid:e,matrix:a.toJson()})),await i.model.setNodeMatrixCollab(e,a)}async function U(e,a,t,o){return!n||C||d||w?d=!1:z("isolate",{nodeids:e,duration:a,fitNodes:t,initiallyHidden:o}),await i.view.isolateNodesCollab(e,0,t,o)}async function q(e,a){return!n||C||u||w?u=!1:z("cadview",{nodeid:e,duration:a}),await i.model.activateCadViewCollab(e,a)}async function G(e){return!n||C||m||w?m=!1:z("explodemagnitude",{magnitude:e}),await i.explodeManager.setMagnitudeCollab(e)}function R(e){!n||C||w||z("markup",{id:e.getUniqueId(),info:i.markupManager.exportMarkup()})}function T(){!n||C||w||z("markup",{id:i.markupManager.getActiveMarkupView().getUniqueId(),info:i.markupManager.exportMarkup()})}function X(){!n||C||w||z("markup",{id:null,info:i.markupManager.exportMarkup()})}async function K(e){!n||C||b||w?b=!1:z("activatemarkupview",{id:e}),i.unsetCallbacks({camera:E}),await i.markupManager.activateMarkupViewWithPromiseCollab(e,0),i.setCallbacks({camera:E})}async function Q(e,a){!n||C||f||w||z("cuttingsection",{id:e,active:!0,csinfo:a.toJson()}),await a.activateCollab()}async function Y(e,a){if(n&&!C&&!f&&!w){z("cuttingsection",{id:e,active:!1,csinfo:a.toJson()})}await a.deactivateCollab()}async function Z(e,a,t,i,o,s,l){await a.updatePlaneCollab(t,i,o,s,l),!n||C||f||w||z("cuttingsection",{id:e,active:!0,csinfo:a.toJson()})}async function ee(e,a,t,i,o){await a.setPlaneCollab(t,i,o),!n||C||f||w||z("cuttingsection",{id:e,active:!0,csinfo:a.toJson()})}async function ae(e,a,t){!n||C||w||z("loadsubtree",{a:e,b:a,c:t}),await i.model.loadSubtreeFromScsFileCollab(e,a,t)}function te(e,a,t){o=t,i=e,g=a,e.setCallbacks({camera:E,selectionArray:D,viewCreated:R,redlineCreated:T,measurementCreated:X}),e.view.setProjectionModeCollab=e.view.setProjectionMode,e.view.setProjectionMode=L,e.view.setDrawModeCollab=e.view.setDrawMode,e.view.setDrawMode=B,e.markupManager.activateMarkupViewWithPromiseCollab=e.markupManager.activateMarkupViewWithPromise,e.markupManager.activateMarkupViewWithPromise=K,e.model.loadSubtreeFromScsFileCollab=e.model.loadSubtreeFromScsFile,e.model.loadSubtreeFromScsFile=ae,e.model.setNodesVisibilityCollab=e.model.setNodesVisibility,e.model.setNodesVisibility=I,e.explodeManager.setMagnitudeCollab=e.explodeManager.setMagnitude,e.explodeManager.setMagnitude=G,e.model.resetNodesVisibilityCollab=e.model.resetNodesVisibility,e.model.resetNodesVisibility=W,e.model.resetCollab=e.model.reset,e.model.reset=_,e.model.clearCollab=e.model.clear,e.model.clear=A,e.model.setNodeMatrixCollab=e.model.setNodeMatrix,e.model.setNodeMatrix=H,e.view.isolateNodesCollab=e.view.isolateNodes,e.view.isolateNodes=U,e.model.activateCadViewCollab=e.model.activateCadView,e.model.activateCadView=q;let s=e.cuttingManager.getCuttingSection(0),l=e.cuttingManager.getCuttingSection(1),r=e.cuttingManager.getCuttingSection(2);if(s&&(s.activateCollab=s.activate,s.activate=function(){Q(0,this)},s.deactivateCollab=s.deactivate,s.deactivate=function(){Y(0,this)},s.updatePlaneCollab=s.updatePlane,s.updatePlane=function(e,a,t,i,o){Z(0,this,e,a,t,i,o)},s.setPlaneCollab=s.setPlane,s.setPlane=function(e,a,t){ee(0,this,e,a,t)}),l&&(l.activateCollab=l.activate,l.activate=function(){Q(1,this)},l.deactivateCollab=l.deactivate,l.deactivate=function(){Y(1,this)},l.updatePlaneCollab=l.updatePlane,l.updatePlane=function(e,a,t,i,o){Z(1,this,e,a,t,i,o)},l.setPlaneCollab=l.setPlane,l.setPlane=function(e,a,t){ee(1,this,e,a,t)}),r&&(r.activateCollab=r.activate,r.activate=function(){Q(2,this)},r.deactivateCollab=r.deactivate,r.deactivate=function(){Y(2,this)},r.updatePlaneCollab=r.updatePlane,r.updatePlane=function(e,a,t,i,o){Z(2,this,e,a,t,i,o)},r.setPlaneCollab=r.setPlane,r.setPlane=function(e,a,t){ee(2,this,e,a,t)}),g){var c=$("#ui-modelbrowser-minimizebutton");c&&c.on("click",(function(){!n||C||w||($(this).hasClass("minimized")?z("minimizebrowser",{}):z("maximizebrowser",{}))}))}}async function ie(e,a,d){t=a;let C={username:a,roomname:e,password:d};(n=await io(o)).emit("joinroom",JSON.stringify(C)),n.on("hcmessage",(async function(e){let a=JSON.parse(e);if(!k||k(a))switch(a.type){case"camera":{let e=Communicator.Camera.fromJson(a.camera);s=!0,i.view.setCamera(e)}break;case"setprojectionmode":i.view.setProjectionModeCollab(a.projectionmode);break;case"selection":{let e=a.selection;l=!0,i.selectionManager.clear();let t=[];for(let a=0;a<e.length;a++){let i,o,n;e[a].faceEntity&&(i=Communicator.Selection.FaceEntity.fromJson(e[a].faceEntity)),e[a].lineEntity&&(o=Communicator.Selection.LineEntity.fromJson(e[a].lineEntity)),e[a].pointEntity&&(n=Communicator.Selection.PointEntity.fromJson(e[a].pointEntity));let s=new Communicator.Selection.SelectionItem.create(e[a].nodeId,null,i,o,n);t.push(s)}for(let e=0;e<t.length;e++)l=!0,i.selectionManager.add(t[e])}break;case"setdrawmode":i.view.setDrawModeCollab(a.drawmode);break;case"activatemarkupview":b=!0,i.unsetCallbacks({camera:E}),await i.markupManager.activateMarkupViewWithPromise(a.id,0),i.setCallbacks({camera:E});break;case"markup":i.unsetCallbacks({viewCreated:R}),i.unsetCallbacks({redlineCreated:R}),i.markupManager.deleteMarkupView(a.id),await i.markupManager.loadMarkupData(a.info),a.id&&i.markupManager.activateMarkupView(a.id),i.markupManager.refreshMarkup(),i.setCallbacks({viewCreated:R}),i.setCallbacks({redlineCreated:R});break;case"loadsubtree":hwv.model.loadSubtreeFromScsFileCollab(a.a,a.b,a.c);break;case"visibility":r=!0,i.model.setNodesVisibility(a.nodeids,a.onoff);break;case"explodemagnitude":m=!0,i.explodeManager.setMagnitude(a.magnitude);break;case"resetvisibilities":r=!0,f=!0,i.model.resetNodesVisibility();break;case"reset":i.model.resetCollab();break;case"clear":i.model.clearCollab();break;case"matrix":c=!0,i.model.setNodeMatrix(a.nodeid,Communicator.Matrix.fromJson(a.matrix));break;case"isolate":s=!0,f=!0,await i.view.isolateNodesCollab(a.nodeids,0,null!=a.fitNodes?a.fitNodes:void 0,null!=a.initiallyHidden?a.initiallyHidden:void 0);break;case"cadview":u=!0,i.model.activateCadView(a.nodeid,null!=a.duration?a.duration:void 0);break;case"cuttingsection":{let e=i.cuttingManager.getCuttingSection(a.id);a.active?(f=!0,c=!0,await e.fromJson(a.csinfo)):e.deactivateCollab(),f=!1}break;case"minimizebrowser":g._modelBrowser._minimizeModelBrowser();break;case"maximizebrowser":g._modelBrowser._maximizeModelBrowser()}})),n.on("initialState",(function(e){let a=JSON.parse(e);if(a.type="initialState",(!k||k(a))&&a.camera){let e=Communicator.Camera.fromJson(a.camera);s=!0,i.view.setCamera(e)}})),n.on("sendInitialState",(function(e){let a={type:"sendInitialState",camera:i.view.getCamera().toJson()};k&&!k(a)||n.emit("initialState",JSON.stringify({recepient:e,state:a}))})),n.on("lockSession",(function(e){k&&!k({user:e,type:"lockSession"})||(v=e,w=!0)})),n.on("unlockSession",(function(e){k&&!k({type:"unlockSession"})||(w=!1)})),n.on("disconnected",(function(e){e==v&&1==w&&(v="",w=!1),k&&k({user:e,type:"disconnected"})})),n.on("chatmessage",(function(e){let a=JSON.parse(e);a.type="chatmessage",k&&k(a)})),n.on("userlist",(function(e){let a=JSON.parse(e);a.type="userlist",k&&k(a)}))}var oe=a.$j,ne=a.zP,se=a.$,le=a.CS,re=a.pw,ce=a.vy,de=a.hy,ue=a.j2,me=a.$T,be=a.dj,fe=a.O5,Ce=a.XG,pe=a.Vt,we=a.f4;export{oe as connect,ne as disconnect,se as getActive,le as getLocalUser,re as getLockedClient,ce as getLockedMaster,de as getSuspendSend,ue as initialize,me as lockSession,be as sendCustomMessage,fe as setMessageReceivedCallback,Ce as setSuspendSend,pe as submitChat,we as unlockSession};