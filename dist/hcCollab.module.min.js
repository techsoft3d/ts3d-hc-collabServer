var e={d:(t,a)=>{for(var i in a)e.o(a,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:a[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{$:()=>k,$T:()=>P,$j:()=>ae,CS:()=>M,O5:()=>z,Vt:()=>J,XG:()=>V,dj:()=>j,f4:()=>N,hy:()=>x,j2:()=>te,pw:()=>h,vy:()=>S,zP:()=>y});var a,i,n=null,o=!1,s=!1,l=!1,r=!1,c=!1,d=!1,u=!1,m=!1,b=!1,f=!1,C=!1,p=!1,w="",v=null,g=null;function k(){return!!n}function y(){n&&(n.disconnect(),n=null),C=!1,p=!1}function M(){if(n)return{id:n.id,name:a}}function S(){return C}function h(){return p}function P(){!n||C||p||n.emit("lockSession",""),C=!0}function N(){n&&C&&n.emit("unlockSession",""),C=!1}function J(e){n.emit("chatmessage",JSON.stringify({user:a,message:e}))}function V(e){f=e}function x(e){return f}function j(e){n&&(e.type="custommessage",e.user=a,n.emit("hcmessage",JSON.stringify(e)))}function O(e,t){n&&(t.type=e,t.user=a,n.emit("hcmessage",JSON.stringify(t)))}function z(e){g=e}function F(e){o||!n||f||p?o=!1:O("camera",{camera:e.toJson()})}function E(e){if(!n||f||s||p)s=!1;else{let e=[],t=hwv.selectionManager.getResults();for(let a=0;a<t.length;a++)e.push(t[a].toJson());O("selection",{selection:e})}}async function D(e,t,a){return!n||f||l||p?l=!1:O("visibility",{nodeids:e,onoff:t}),await i.model.setNodesVisibilityCollab(e,t,a)}async function I(){return!n||f||l||p?l=!1:O("resetvisibilities",{}),await i.model.resetNodesVisibilityCollab()}async function W(e){return!n||f||p||O("setdrawmode",{drawmode:e}),await i.view.setDrawModeCollab(e)}async function B(e){return!n||f||p||O("setprojectionmode",{projectionmode:e}),await i.view.setProjectionModeCollab(e)}async function L(){return!n||f||p||O("reset",{}),await i.model.resetCollab()}async function _(){return!n||f||p||O("clear",{}),await i.model.clearCollab()}async function A(e,t){return!n||f||r||p?r=!1:(t.toJson(),O("matrix",{nodeid:e,matrix:t.toJson()})),await i.model.setNodeMatrixCollab(e,t)}async function H(e,t,a,o){return!n||f||c||p?c=!1:O("isolate",{nodeids:e,duration:t,fitNodes:a,initiallyHidden:o}),await i.view.isolateNodesCollab(e,0,a,o)}async function U(e,t){return!n||f||d||p?d=!1:O("cadview",{nodeid:e,duration:t}),await i.model.activateCadViewCollab(e,t)}async function q(e){return!n||f||u||p?u=!1:O("explodemagnitude",{magnitude:e}),await i.explodeManager.setMagnitudeCollab(e)}function G(e){!n||f||p||O("markup",{id:e.getUniqueId(),info:i.markupManager.exportMarkup()})}function R(){!n||f||p||O("markup",{id:i.markupManager.getActiveMarkupView().getUniqueId(),info:i.markupManager.exportMarkup()})}function T(){!n||f||p||O("markup",{id:null,info:i.markupManager.exportMarkup()})}async function X(e){!n||f||m||p?m=!1:O("activatemarkupview",{id:e}),i.unsetCallbacks({camera:F}),await i.markupManager.activateMarkupViewWithPromiseCollab(e,0),i.setCallbacks({camera:F})}async function K(e,t){!n||f||b||p||O("cuttingsection",{id:e,active:!0,csinfo:t.toJson()}),await t.activateCollab()}async function Q(e,t){if(n&&!f&&!b&&!p){O("cuttingsection",{id:e,active:!1,csinfo:t.toJson()})}await t.deactivateCollab()}async function Y(e,t,a,i,o,s,l){await t.updatePlaneCollab(a,i,o,s,l),!n||f||b||p||O("cuttingsection",{id:e,active:!0,csinfo:t.toJson()})}async function Z(e,t,a,i,o){await t.setPlaneCollab(a,i,o),!n||f||b||p||O("cuttingsection",{id:e,active:!0,csinfo:t.toJson()})}async function ee(e,t,a){!n||f||p||O("loadsubtree",{a:e,b:t,c:a}),await i.model.loadSubtreeFromScsFileCollab(e,t,a)}function te(e,t){i=e,v=t,e.setCallbacks({camera:F,selectionArray:E,viewCreated:G,redlineCreated:R,measurementCreated:T}),e.view.setProjectionModeCollab=e.view.setProjectionMode,e.view.setProjectionMode=B,e.view.setDrawModeCollab=e.view.setDrawMode,e.view.setDrawMode=W,e.markupManager.activateMarkupViewWithPromiseCollab=e.markupManager.activateMarkupViewWithPromise,e.markupManager.activateMarkupViewWithPromise=X,e.model.loadSubtreeFromScsFileCollab=e.model.loadSubtreeFromScsFile,e.model.loadSubtreeFromScsFile=ee,e.model.setNodesVisibilityCollab=e.model.setNodesVisibility,e.model.setNodesVisibility=D,e.explodeManager.setMagnitudeCollab=e.explodeManager.setMagnitude,e.explodeManager.setMagnitude=q,e.model.resetNodesVisibilityCollab=e.model.resetNodesVisibility,e.model.resetNodesVisibility=I,e.model.resetCollab=e.model.reset,e.model.reset=L,e.model.clearCollab=e.model.clear,e.model.clear=_,e.model.setNodeMatrixCollab=e.model.setNodeMatrix,e.model.setNodeMatrix=A,e.view.isolateNodesCollab=e.view.isolateNodes,e.view.isolateNodes=H,e.model.activateCadViewCollab=e.model.activateCadView,e.model.activateCadView=U;let a=e.cuttingManager.getCuttingSection(0),o=e.cuttingManager.getCuttingSection(1),s=e.cuttingManager.getCuttingSection(2);if(a.activateCollab=a.activate,a.activate=function(){K(0,this)},o.activateCollab=o.activate,o.activate=function(){K(1,this)},s.activateCollab=s.activate,s.activate=function(){K(2,this)},a.deactivateCollab=a.deactivate,a.deactivate=function(){Q(0,this)},o.deactivateCollab=o.deactivate,o.deactivate=function(){Q(1,this)},s.deactivateCollab=s.deactivate,s.deactivate=function(){Q(2,this)},a.updatePlaneCollab=a.updatePlane,a.updatePlane=function(e,t,a,i,n){Y(0,this,e,t,a,i,n)},o.updatePlaneCollab=o.updatePlane,o.updatePlane=function(e,t,a,i,n){Y(1,this,e,t,a,i,n)},s.updatePlaneCollab=s.updatePlane,s.updatePlane=function(e,t,a,i,n){Y(2,this,e,t,a,i,n)},a.setPlaneCollab=a.setPlane,a.setPlane=function(e,t,a){Z(0,this,e,t,a)},o.setPlaneCollab=o.setPlane,o.setPlane=function(e,t,a){Z(1,this,e,t,a)},s.setPlaneCollab=s.setPlane,s.setPlane=function(e,t,a){Z(2,this,e,t,a)},v){var l=$("#ui-modelbrowser-minimizebutton");l&&l.on("click",(function(){!n||f||p||($(this).hasClass("minimized")?O("minimizebrowser",{}):O("maximizebrowser",{}))}))}}async function ae(e,t){a=t;let c={username:t,roomname:e};(n=await io()).emit("joinroom",JSON.stringify(c)),n.on("hcmessage",(async function(e){let t=JSON.parse(e);if(!g||g(t))switch(t.type){case"camera":{let e=Communicator.Camera.fromJson(t.camera);o=!0,i.view.setCamera(e)}break;case"setprojectionmode":i.view.setProjectionModeCollab(t.projectionmode);break;case"selection":{let e=t.selection;s=!0,i.selectionManager.clear();let a=[];for(let t=0;t<e.length;t++){let i,n,o;e[t].faceEntity&&(i=Communicator.Selection.FaceEntity.fromJson(e[t].faceEntity)),e[t].lineEntity&&(n=Communicator.Selection.LineEntity.fromJson(e[t].lineEntity)),e[t].pointEntity&&(o=Communicator.Selection.PointEntity.fromJson(e[t].pointEntity));let s=new Communicator.Selection.SelectionItem.create(e[t].nodeId,null,i,n,o);a.push(s)}for(let e=0;e<a.length;e++)s=!0,i.selectionManager.add(a[e])}break;case"setdrawmode":i.view.setDrawModeCollab(t.drawmode);break;case"activatemarkupview":m=!0,i.unsetCallbacks({camera:F}),await i.markupManager.activateMarkupViewWithPromise(t.id,0),i.setCallbacks({camera:F});break;case"markup":i.unsetCallbacks({viewCreated:G}),i.unsetCallbacks({redlineCreated:G}),i.markupManager.deleteMarkupView(t.id),await i.markupManager.loadMarkupData(t.info),t.id&&i.markupManager.activateMarkupView(t.id),i.markupManager.refreshMarkup(),i.setCallbacks({viewCreated:G}),i.setCallbacks({redlineCreated:G});break;case"loadsubtree":hwv.model.loadSubtreeFromScsFileCollab(t.a,t.b,t.c);break;case"visibility":l=!0,i.model.setNodesVisibility(t.nodeids,t.onoff);break;case"explodemagnitude":u=!0,i.explodeManager.setMagnitude(t.magnitude);break;case"resetvisibilities":l=!0,b=!0,i.model.resetNodesVisibility();break;case"reset":i.model.resetCollab();break;case"clear":i.model.clearCollab();break;case"matrix":r=!0,i.model.setNodeMatrix(t.nodeid,Communicator.Matrix.fromJson(t.matrix));break;case"isolate":o=!0,b=!0,await i.view.isolateNodesCollab(t.nodeids,0,null!=t.fitNodes?t.fitNodes:void 0,null!=t.initiallyHidden?t.initiallyHidden:void 0);break;case"cadview":d=!0,i.model.activateCadView(t.nodeid,null!=t.duration?t.duration:void 0);break;case"cuttingsection":{let e=i.cuttingManager.getCuttingSection(t.id);t.active?(b=!0,r=!0,await e.fromJson(t.csinfo)):e.deactivateCollab(),b=!1}break;case"minimizebrowser":v._modelBrowser._minimizeModelBrowser();break;case"maximizebrowser":v._modelBrowser._maximizeModelBrowser()}})),n.on("initialState",(function(e){let t=JSON.parse(e);if(t.type="initialState",(!g||g(t))&&t.camera){let e=Communicator.Camera.fromJson(t.camera);o=!0,i.view.setCamera(e)}})),n.on("sendInitialState",(function(e){let t={type:"sendInitialState",camera:i.view.getCamera().toJson()};g&&!g(t)||n.emit("initialState",JSON.stringify({recepient:e,state:t}))})),n.on("lockSession",(function(e){g&&!g({user:e,type:"lockSession"})||(w=e,p=!0)})),n.on("unlockSession",(function(e){g&&!g({type:"unlockSession"})||(p=!1)})),n.on("disconnected",(function(e){e==w&&1==p&&(w="",p=!1),g&&g({user:e,type:"disconnected"})})),n.on("chatmessage",(function(e){let t=JSON.parse(e);t.type="chatmessage",g&&g(t)})),n.on("userlist",(function(e){let t=JSON.parse(e);t.type="userlist",g&&g(t)}))}var ie=t.$j,ne=t.zP,oe=t.$,se=t.CS,le=t.pw,re=t.vy,ce=t.hy,de=t.j2,ue=t.$T,me=t.dj,be=t.O5,fe=t.XG,Ce=t.Vt,pe=t.f4;export{ie as connect,ne as disconnect,oe as getActive,se as getLocalUser,le as getLockedClient,re as getLockedMaster,ce as getSuspendSend,de as initialize,ue as lockSession,me as sendCustomMessage,be as setMessageReceivedCallback,fe as setSuspendSend,Ce as submitChat,pe as unlockSession};